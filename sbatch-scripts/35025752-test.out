Found 2 GPU cards for training
Choose random seed 9262
loading dictionary from ./data/glove/dictionary.pkl
loading features from h5 file ./data/Bottom-up-features-adaptive/val.hdf5
Setting semantic adj matrix to None...
Setting spatial adj matrix to None...
loading features from h5 file ./data/Bottom-up-features-adaptive/train.hdf5
Setting semantic adj matrix to None...
Setting spatial adj matrix to None...
Building ReGAT model with implicit relation and butd fusion method
In ImplicitRelationEncoder, num of graph propogate steps: 1, residual_connection: True
embedding dim is 300
tf-idf stochastic matrix (19901 x 28333) is generated.
DataParallel(
  (module): ReGAT(
    (w_emb): WordEmbedding(
      (emb): Embedding(19902, 300, padding_idx=19901)
      (emb_): Embedding(19902, 300, padding_idx=19901)
      (dropout): Dropout(p=0.0, inplace=False)
    )
    (q_emb): QuestionEmbedding(
      (rnn): GRU(600, 1024, batch_first=True)
    )
    (q_att): QuestionSelfAttention(
      (drop): Dropout(p=0.2, inplace=False)
      (W1_self_att_q): FCNet(
        (main): Sequential(
          (0): Dropout(p=0.2, inplace=False)
          (1): Linear(in_features=1024, out_features=1024, bias=True)
        )
      )
      (W2_self_att_q): FCNet(
        (main): Sequential(
          (0): Linear(in_features=1024, out_features=1, bias=True)
        )
      )
    )
    (v_relation): ImplicitRelationEncoder(
      (v_transform): FCNet(
        (main): Sequential(
          (0): Linear(in_features=2048, out_features=1024, bias=True)
          (1): ReLU()
        )
      )
      (implicit_relation): GAttNet(
        (dropout): Dropout(p=0.2, inplace=False)
        (self_weights): FCNet(
          (main): Sequential(
            (0): Dropout(p=0.2, inplace=False)
            (1): Linear(in_features=2048, out_features=1024, bias=True)
          )
        )
        (bias): FCNet(
          (main): Sequential(
            (0): Linear(in_features=1, out_features=1, bias=False)
          )
        )
        (neighbor_net): ModuleList(
          (0-1): 2 x GraphSelfAttentionLayer(
            (pair_pos_fc1): FCNet(
              (main): Sequential(
                (0): Dropout(p=0.2, inplace=False)
                (1): Linear(in_features=64, out_features=16, bias=True)
              )
            )
            (query): FCNet(
              (main): Sequential(
                (0): Dropout(p=0.2, inplace=False)
                (1): Linear(in_features=1024, out_features=1024, bias=True)
              )
            )
            (key): FCNet(
              (main): Sequential(
                (0): Dropout(p=0.2, inplace=False)
                (1): Linear(in_features=1024, out_features=1024, bias=True)
              )
            )
            (linear_out_): Conv2d(16384, 1024, kernel_size=(1, 1), stride=(1, 1), groups=16)
          )
        )
      )
    )
    (joint_embedding): BUTD(
      (v_proj): FCNet(
        (main): Sequential(
          (0): Linear(in_features=1024, out_features=1024, bias=True)
          (1): ReLU()
        )
      )
      (q_proj): FCNet(
        (main): Sequential(
          (0): Linear(in_features=1024, out_features=1024, bias=True)
          (1): ReLU()
        )
      )
      (dropout): Dropout(p=0.2, inplace=False)
      (linear): FCNet(
        (main): Sequential(
          (0): Linear(in_features=1024, out_features=1, bias=True)
          (1): ReLU()
        )
      )
      (q_net): FCNet(
        (main): Sequential(
          (0): Linear(in_features=1024, out_features=1024, bias=True)
          (1): ReLU()
        )
      )
      (v_net): FCNet(
        (main): Sequential(
          (0): Linear(in_features=1024, out_features=1024, bias=True)
          (1): ReLU()
        )
      )
    )
    (classifier): SimpleClassifier(
      (main): Sequential(
        (0): Linear(in_features=1024, out_features=2048, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=2048, out_features=3129, bias=True)
      )
    )
  )
)
nParams=	41192896
optim: adamax lr=0.0010, decay_step=2, decay_rate=0.25,grad_clip=0.25
LR decay epochs: 15,17,19
gradual warmup lr: 0.0005
